---
sidebar_position: 4
---

# SMB, LDAP, Kerberos

## SMB

## LDAP

> LDAP (Lightweight Directory Access Protocol) is a software protocol for enabling anyone to locate organizations, individuals, and other resources such as files and devices in a network, whether on the public Internet or on a corporate intranet.

Think of it as a tree structure for the entire organization.

Enumeration with [python](https://book.hacktricks.xyz/pentesting/pentesting-ldap#basic-enumeration) or with ldapsearch:

```bash
# without creds
ldapsearch -x -h <IP> -D '' -w '' -b "DC=<1_SUBDOMAIN>,DC=<TLD>"

# with creds
ldapsearch -x -h <IP> -D '<DOMAIN>\<username>' -w '<password>' -b "DC=<1_SUBDOMAIN>,DC=<TLD>"

# with creds, kerberos instead of NTLM
ldapsearch -x -h <IP> -D '<DOMAIN>\<username>' -w '<password>' -Y GSSAPI -b "DC=<1_SUBDOMAIN>,DC=<TLD>"

```
When you have creds, you can try to dump data, change `CN` for different info:
```bash
# Commonly used CN values
# CN=Users              -> extract users
# CN=Computers          -> extract computers
# CN=<MY NAME>          -> extract my info
# CN=Domain Admins      -> extract domain admins
# CN=Domain Users       -> extract domain users
# CN=Enterprise Admins  -> extract enterprise admins
# CN=Administrators     -> extract Administrators
# CN=Remote Desktop Users   -> extract RDP users

ldapsearch -x -h <IP> -D '<DOMAIN>\<username>' -w '<password>' -b "CN=<CN>,DC=<1_SUBDOMAIN>,DC=<TLD>"
```

Dump everything
```bash
ldapsearch -x -h <IP> -D '<DOMAIN>\<username>' -w '<password>' -b "DC=<1_SUBDOMAIN>,DC=<TLD>"
# -x Simple Authentication
# -h LDAP Server
# -D My User
# -w My password
# -b Base site, all data from here will be given
```

## Kerberos